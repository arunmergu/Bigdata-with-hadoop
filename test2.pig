firststep = load '/home/hduser/2000.txt' using PigStorage(',') as (productid,storename : chararray,jan : double,feb : double,mar : double,april : double,may : double,june : double,july : double,august : double,september : double,october : double,november : double,december : double);
dump firststep;
secondstep = foreach firststep generate $0,$1,$2+$3+$4+$5+$6+$7+$8+$9+$10+$11+$12+$13;
dump secondstep;
thirdstep = load '/home/hduser/2001.txt' using PigStorage(',') as (productid,storename : chararray,jan : double,feb : double,mar : double,april : double,may : double,june : double,july : double,august : double,september : double,october : double,november : double,december : double);
dump thirdstep;
fourthstep = foreach thirdstep generate $0,$1,$2+$3+$4+$5+$6+$7+$8+$9+$10+$11+$12+$13;
dump fourthstep;
fifthstep = load '/home/hduser/2002.txt' using PigStorage(',') as (productid,storename : chararray,jan : double,feb : double,mar : double,april : double,may : double,june : double,july : double,august : double,september : double,october : double,november : double,december : double);
dump fifthstep;
sixthstep = foreach fifthstep generate $0,$1,$2+$3+$4+$5+$6+$7+$8+$9+$10+$11+$12+$13;
dump sixthstep;
seventhstep = join secondstep by $0,fourthstep by $0,sixthstep by $0;
dump seventhstep;
eightstep = foreach seventhstep generate $0,$1,$2,$5,$8;
dump eightstep;
ninthstep = foreach eightstep generate $0,$1,$2,$3,$4,(($3-$2)/$2)*100,(($4-$3)/$3)*100;
dump ninthstep;
tenthstep = foreach ninthstep generate $0,$1,$2,$3,$4,$5,$6,($5+$6)/2;
dump tenthstep;
eleventhstep = filter tenthstep by $7>10;
dump eleventhstep;
store eleventhstep into '/home/hduser/output1';
twelvethstep = filter tenthstep by $7<-5;
dump twelvethstep;
store twelvethstep into '/home/hduser/output2';
thirteenthstep = foreach eightstep generate $0,$1,$2+$3+$4;
dump thirteenthstep;
fourteenthstep = order thirteenthstep by $2 desc;
dump fourteenthstep;
fifteenthstep = limit fourteenthstep 5;
dump fifteenthstep;
store fifteenthstep into '/home/hduser/output4';
sixteenthstep = order thirteenthstep by $2;
dump sixteenthstep;
seventeenthstep = limit sixteenthstep 5;
dump seventeenthstep;
store seventeenthstep into '/home/hduser/output3';


